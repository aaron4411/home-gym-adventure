<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ¦– Home Gym Adventure ğŸ¦‹</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'Quicksand', sans-serif; background: #0a0a1a; min-height: 100vh; overflow-x: hidden; }
    .starfield { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 0; overflow: hidden; }
    .star { position: absolute; background: white; border-radius: 50%; animation: twinkle 3s infinite ease-in-out; }
    @keyframes twinkle { 0%, 100% { opacity: 0.3; transform: scale(1); } 50% { opacity: 1; transform: scale(1.2); } }
    .grid-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-image: linear-gradient(rgba(0,255,255,0.03) 1px, transparent 1px), linear-gradient(90deg, rgba(0,255,255,0.03) 1px, transparent 1px); background-size: 50px 50px; pointer-events: none; z-index: 1; }
    .scanlines { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: repeating-linear-gradient(0deg, rgba(0,0,0,0.1) 0px, rgba(0,0,0,0.1) 1px, transparent 1px, transparent 2px); pointer-events: none; z-index: 1000; opacity: 0.3; }
    @keyframes confettiFall { 0% { transform: translateY(0) rotate(0deg); opacity: 1; } 100% { transform: translateY(100vh) rotate(720deg); opacity: 0; } }
    @keyframes popIn { 0% { transform: scale(0.5); opacity: 0; } 50% { transform: scale(1.1); } 100% { transform: scale(1); opacity: 1; } }
    @keyframes neonPulse { 0%, 100% { box-shadow: 0 0 5px currentColor, 0 0 10px currentColor, 0 0 20px currentColor; } 50% { box-shadow: 0 0 10px currentColor, 0 0 20px currentColor, 0 0 40px currentColor, 0 0 60px currentColor; } }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-10px); } }
    @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
    input:focus, select:focus, button:focus, textarea:focus { outline: none; }
    button { transition: all 0.2s ease; font-family: 'Quicksand', sans-serif; }
    button:hover:not(:disabled) { transform: translateY(-2px) scale(1.02); }
    button:active:not(:disabled) { transform: translateY(0) scale(0.98); }
    .neon-card { background: linear-gradient(135deg, rgba(20,20,40,0.9) 0%, rgba(30,30,60,0.9) 100%); border: 2px solid #00ffff; box-shadow: 0 0 20px rgba(0,255,255,0.3), inset 0 0 20px rgba(0,255,255,0.05); backdrop-filter: blur(10px); }
    .arcade-btn { font-family: 'Orbitron', sans-serif; text-transform: uppercase; letter-spacing: 2px; position: relative; overflow: hidden; }
    .arcade-btn::before { content: ''; position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent); transition: left 0.5s; }
    .arcade-btn:hover::before { left: 100%; }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    const StarField = () => {
      const stars = Array.from({ length: 100 }, (_, i) => ({ id: i, left: Math.random() * 100, top: Math.random() * 100, size: Math.random() * 3 + 1, delay: Math.random() * 3, duration: Math.random() * 2 + 2 }));
      return (<div className="starfield">{stars.map(star => (<div key={star.id} className="star" style={{ left: `${star.left}%`, top: `${star.top}%`, width: `${star.size}px`, height: `${star.size}px`, animationDelay: `${star.delay}s`, animationDuration: `${star.duration}s` }} />))}</div>);
    };

    const COLOR_OPTIONS = [
      { id: 'cyan', gradient: 'linear-gradient(135deg, #00ffff 0%, #0080ff 100%)', primary: '#00ffff', glow: '0 0 20px #00ffff' },
      { id: 'magenta', gradient: 'linear-gradient(135deg, #ff00ff 0%, #ff0080 100%)', primary: '#ff00ff', glow: '0 0 20px #ff00ff' },
      { id: 'lime', gradient: 'linear-gradient(135deg, #00ff00 0%, #80ff00 100%)', primary: '#00ff00', glow: '0 0 20px #00ff00' },
      { id: 'gold', gradient: 'linear-gradient(135deg, #ffff00 0%, #ffaa00 100%)', primary: '#ffff00', glow: '0 0 20px #ffff00' },
      { id: 'orange', gradient: 'linear-gradient(135deg, #ff8000 0%, #ff4000 100%)', primary: '#ff8000', glow: '0 0 20px #ff8000' },
      { id: 'pink', gradient: 'linear-gradient(135deg, #ff80ff 0%, #ff00aa 100%)', primary: '#ff80ff', glow: '0 0 20px #ff80ff' },
      { id: 'blue', gradient: 'linear-gradient(135deg, #4080ff 0%, #0040ff 100%)', primary: '#4080ff', glow: '0 0 20px #4080ff' },
      { id: 'purple', gradient: 'linear-gradient(135deg, #aa00ff 0%, #6600ff 100%)', primary: '#aa00ff', glow: '0 0 20px #aa00ff' },
    ];

    const AVATARS = [
      { id: 'trex', name: 'T-Rex', emoji: 'ğŸ¦–', badges: ['Baby Rex', 'Young Rex', 'Mighty T-Rex'] },
      { id: 'stego', name: 'Stegosaurus', emoji: 'ğŸ¦•', badges: ['Tiny Stego', 'Growing Stego', 'Grand Stegosaurus'] },
      { id: 'lion', name: 'Lion', emoji: 'ğŸ¦', badges: ['Lion Cub', 'Young Lion', 'King of Jungle'] },
      { id: 'butterfly', name: 'Butterfly', emoji: 'ğŸ¦‹', badges: ['Caterpillar', 'Cocoon', 'Beautiful Butterfly'] },
      { id: 'frog', name: 'Frog', emoji: 'ğŸ¸', badges: ['Tadpole', 'Froglet', 'Leaping Frog'] },
      { id: 'eagle', name: 'Eagle', emoji: 'ğŸ¦…', badges: ['Eaglet', 'Fledgling', 'Soaring Eagle'] },
      { id: 'tiger', name: 'Tiger', emoji: 'ğŸ¯', badges: ['Tiger Cub', 'Young Tiger', 'Fierce Tiger'] },
      { id: 'dragon', name: 'Dragon', emoji: 'ğŸ‰', badges: ['Dragon Egg', 'Hatchling', 'Mighty Dragon'] },
      { id: 'unicorn', name: 'Unicorn', emoji: 'ğŸ¦„', badges: ['Baby Unicorn', 'Young Unicorn', 'Magical Unicorn'] },
      { id: 'bee', name: 'Bee', emoji: 'ğŸ', badges: ['Larva Bee', 'Worker Bee', 'Queen Bee'] },
      { id: 'ladybug', name: 'Ladybug', emoji: 'ğŸ', badges: ['Tiny Dot', 'Spotted Bug', 'Lucky Ladybug'] },
      { id: 'bear', name: 'Bear', emoji: 'ğŸ»', badges: ['Baby Cub', 'Young Bear', 'Big Bear'] },
    ];

    const LEVELS = [
      { level: 1, name: 'Stardust', minXP: 0, emoji: 'âœ¨' },
      { level: 2, name: 'Comet', minXP: 100, emoji: 'â˜„ï¸' },
      { level: 3, name: 'Moon Walker', minXP: 300, emoji: 'ğŸŒ™' },
      { level: 4, name: 'Star Pilot', minXP: 600, emoji: 'â­' },
      { level: 5, name: 'Nebula Master', minXP: 1000, emoji: 'ğŸŒŒ' },
      { level: 6, name: 'Galaxy Hero', minXP: 1500, emoji: 'ğŸŒŸ' },
      { level: 7, name: 'Cosmic Legend', minXP: 2500, emoji: 'ğŸ’«' },
      { level: 8, name: 'Universe Champion', minXP: 4000, emoji: 'ğŸ†' },
    ];

    const generateAvatarBadges = () => {
      const badges = [];
      AVATARS.forEach(avatar => {
        avatar.badges.forEach((badgeName, index) => {
          const threshold = index === 0 ? 1 : index === 1 ? 5 : 10;
          badges.push({ id: `${avatar.id}_${index + 1}`, name: badgeName, emoji: avatar.emoji, description: `Complete ${threshold} ${threshold === 1 ? 'activity' : 'activities'} as ${avatar.name}`, avatarId: avatar.id, threshold, tier: index + 1 });
        });
      });
      return badges;
    };
    const AVATAR_BADGES = generateAvatarBadges();

    const BADGES = [
      { id: 'first_steps', name: 'First Steps', emoji: 'ğŸ‘£', description: 'Complete your first activity', condition: (s) => s.totalCompleted >= 1 },
      { id: 'getting_warmed_up', name: 'Warming Up', emoji: 'ğŸ”¥', description: 'Complete 5 activities', condition: (s) => s.totalCompleted >= 5 },
      { id: 'on_fire', name: 'On Fire!', emoji: 'ğŸŒŸ', description: 'Complete 10 activities', condition: (s) => s.totalCompleted >= 10 },
      { id: 'unstoppable', name: 'Unstoppable', emoji: 'ğŸ’ª', description: 'Complete 25 activities', condition: (s) => s.totalCompleted >= 25 },
      { id: 'superstar', name: 'Superstar', emoji: 'ğŸŒ ', description: 'Complete 50 activities', condition: (s) => s.totalCompleted >= 50 },
      { id: 'century', name: 'Century Club', emoji: 'ğŸ’¯', description: 'Earn 100 points', condition: (s) => s.totalPoints >= 100 },
      { id: 'five_hundred', name: 'High Scorer', emoji: 'ğŸ¯', description: 'Earn 500 points', condition: (s) => s.totalPoints >= 500 },
      { id: 'thousand', name: 'Point Master', emoji: 'ğŸ…', description: 'Earn 1000 points', condition: (s) => s.totalPoints >= 1000 },
      { id: 'two_thousand', name: 'XP Legend', emoji: 'ğŸ‘‘', description: 'Earn 2000 points', condition: (s) => s.totalPoints >= 2000 },
      { id: 'balance_starter', name: 'Finding Balance', emoji: 'ğŸ§˜', description: 'Complete 3 balance activities', condition: (s) => s.balanceCompleted >= 3 },
      { id: 'balance_master', name: 'Balance Master', emoji: 'âš–ï¸', description: 'Complete 10 balance activities', condition: (s) => s.balanceCompleted >= 10 },
      { id: 'jump_starter', name: 'First Jumps', emoji: 'ğŸ¦˜', description: 'Complete 3 jumping activities', condition: (s) => s.jumpCompleted >= 3 },
      { id: 'jump_champion', name: 'Jump Champion', emoji: 'ğŸš€', description: 'Complete 10 jumping activities', condition: (s) => s.jumpCompleted >= 10 },
      { id: 'team_starter', name: 'Team Spirit', emoji: 'ğŸ¤', description: 'Complete 3 team activities', condition: (s) => s.teamCompleted >= 3 },
      { id: 'team_player', name: 'Team Player', emoji: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦', description: 'Complete 10 team activities', condition: (s) => s.teamCompleted >= 10 },
      { id: 'strength_starter', name: 'Getting Strong', emoji: 'ğŸ’ª', description: 'Complete 3 strength activities', condition: (s) => s.strengthCompleted >= 3 },
      { id: 'strength_hero', name: 'Strength Hero', emoji: 'ğŸ¦¸', description: 'Complete 10 strength activities', condition: (s) => s.strengthCompleted >= 10 },
      { id: 'favorite_finder', name: 'Favorite Finder', emoji: 'â¤ï¸', description: 'Add 3 activities to favorites', condition: (s) => s.favoritesCount >= 3 },
      { id: 'explorer', name: 'Activity Explorer', emoji: 'ğŸ§­', description: 'Try 15 different activities', condition: (s) => s.uniqueActivities >= 15 },
      { id: 'adventurer', name: 'Grand Adventurer', emoji: 'ğŸ—ºï¸', description: 'Try 30 different activities', condition: (s) => s.uniqueActivities >= 30 },
      { id: 'streak_starter', name: 'Streak Starter', emoji: 'ğŸ“…', description: 'Complete activities 3 different days', condition: (s) => s.uniqueDays >= 3 },
      { id: 'weekly_warrior', name: 'Weekly Warrior', emoji: 'ğŸ—“ï¸', description: 'Complete activities 7 different days', condition: (s) => s.uniqueDays >= 7 },
      { id: 'monthly_master', name: 'Monthly Master', emoji: 'ğŸ“†', description: 'Complete activities 14 different days', condition: (s) => s.uniqueDays >= 14 },
      { id: 'dance_starter', name: 'Dance Beginner', emoji: 'ğŸ’ƒ', description: 'Complete 3 dance activities', condition: (s) => s.danceCompleted >= 3 },
      { id: 'dance_star', name: 'Dance Star', emoji: 'ğŸ•º', description: 'Complete 10 dance activities', condition: (s) => s.danceCompleted >= 10 },
      { id: 'yoga_beginner', name: 'Yoga Beginner', emoji: 'ğŸ§˜â€â™€ï¸', description: 'Complete 3 yoga activities', condition: (s) => s.yogaCompleted >= 3 },
      { id: 'zen_master', name: 'Zen Master', emoji: 'â˜¯ï¸', description: 'Complete 10 yoga activities', condition: (s) => s.yogaCompleted >= 10 },
      { id: 'obstacle_runner', name: 'Obstacle Runner', emoji: 'ğŸƒ', description: 'Complete 3 obstacle courses', condition: (s) => s.obstacleCompleted >= 3 },
      { id: 'ninja_warrior', name: 'Ninja Warrior', emoji: 'ğŸ¥·', description: 'Complete 10 obstacle courses', condition: (s) => s.obstacleCompleted >= 10 },
    ];

    const EQUIPMENT_OPTIONS = [
      { id: 'cones', name: 'Saucer Cones', emoji: 'ğŸ”¶' }, { id: 'foam_balls', name: 'Foam Balls', emoji: 'ğŸ”´' },
      { id: 'plyo_6', name: 'Plyo Box 6"', emoji: 'ğŸ“¦' }, { id: 'plyo_12', name: 'Plyo Box 12"', emoji: 'ğŸ“¦' },
      { id: 'plyo_18', name: 'Plyo Box 18"', emoji: 'ğŸ“¦' }, { id: 'bosu', name: 'Bosu Ball', emoji: 'ğŸ”µ' },
      { id: 'yoga_mat', name: 'Yoga Mat', emoji: 'ğŸ§˜' }, { id: 'yoga_blocks', name: 'Yoga Blocks', emoji: 'ğŸ§±' },
      { id: 'weights', name: 'Light Weights', emoji: 'ğŸ‹ï¸' }, { id: 'balance_beam', name: 'Balance Beam', emoji: 'â–' },
      { id: 'barre', name: 'Ballet Barre', emoji: 'ğŸ©°' }, { id: 'stepping_stones', name: 'Stepping Stones', emoji: 'ğŸª¨' },
      { id: 'blankets', name: 'Blankets', emoji: 'ğŸ›ï¸' }, { id: 'spotify', name: 'Music', emoji: 'ğŸµ' }, { id: 'lights', name: 'Lights', emoji: 'ğŸ’¡' },
    ];

    const ACTIVITY_LIBRARY = [
      { id: 1, name: 'T-Rex Stomps', description: 'Stomp around like a mighty T-Rex! Do 10 big stomping jumps.', equipment: [], minAge: 3, maxAge: 12, points: 15, duration: '2 min', difficulty: 'Easy', category: 'jump', tags: ['jump', 'cardio'] },
      { id: 2, name: 'Frog Pond Hop', description: 'Hop from stone to stone like a frog!', equipment: ['stepping_stones'], minAge: 3, maxAge: 10, points: 20, duration: '3 min', difficulty: 'Easy', category: 'jump', tags: ['jump', 'coordination'] },
      { id: 3, name: 'Kangaroo Box Jumps', description: 'Jump up onto the plyo box like a kangaroo!', equipment: ['plyo_6'], minAge: 5, maxAge: 12, points: 25, duration: '3 min', difficulty: 'Medium', category: 'jump', tags: ['jump', 'strength'] },
      { id: 4, name: 'Grasshopper Challenge', description: 'How many jumps can you do in 30 seconds?', equipment: ['cones'], minAge: 4, maxAge: 12, points: 20, duration: '2 min', difficulty: 'Medium', category: 'jump', tags: ['jump', 'speed'] },
      { id: 5, name: 'Dinosaur Escape', description: 'A meteor is coming! Run through the cone obstacle course!', equipment: ['cones'], minAge: 4, maxAge: 12, points: 30, duration: '4 min', difficulty: 'Medium', category: 'jump', tags: ['jump', 'cardio', 'team'] },
      { id: 6, name: 'Flamingo Stand', description: 'Stand on one leg like a flamingo! Hold for 20 seconds.', equipment: [], minAge: 3, maxAge: 12, points: 15, duration: '2 min', difficulty: 'Easy', category: 'balance', tags: ['balance'] },
      { id: 7, name: 'Tightrope Walker', description: 'Walk across the balance beam like a circus performer!', equipment: ['balance_beam'], minAge: 3, maxAge: 10, points: 20, duration: '3 min', difficulty: 'Easy', category: 'balance', tags: ['balance', 'coordination'] },
      { id: 8, name: 'Surfing Dino', description: 'Stand on the Bosu ball like surfing a wave!', equipment: ['bosu'], minAge: 5, maxAge: 12, points: 25, duration: '3 min', difficulty: 'Medium', category: 'balance', tags: ['balance', 'core'] },
      { id: 9, name: 'Eagle Pose Challenge', description: 'Do the yoga eagle pose!', equipment: ['yoga_mat'], minAge: 5, maxAge: 12, points: 20, duration: '2 min', difficulty: 'Medium', category: 'balance', tags: ['balance', 'flexibility'] },
      { id: 10, name: 'Stepping Stone River', description: 'Cross the lava river stepping only on stones!', equipment: ['stepping_stones'], minAge: 3, maxAge: 10, points: 25, duration: '4 min', difficulty: 'Medium', category: 'balance', tags: ['balance', 'coordination'] },
      { id: 11, name: 'Stork Walk', description: 'Walk on beam with a yoga block on your head!', equipment: ['balance_beam', 'yoga_blocks'], minAge: 5, maxAge: 12, points: 30, duration: '3 min', difficulty: 'Hard', category: 'balance', tags: ['balance', 'coordination'] },
      { id: 12, name: 'Bear Crawl Safari', description: 'Crawl like a bear around the room!', equipment: ['cones'], minAge: 3, maxAge: 12, points: 20, duration: '3 min', difficulty: 'Medium', category: 'strength', tags: ['strength', 'cardio'] },
      { id: 13, name: 'Gorilla Pounds', description: 'Beat your chest and do arm swings with weights!', equipment: ['weights'], minAge: 6, maxAge: 12, points: 25, duration: '3 min', difficulty: 'Medium', category: 'strength', tags: ['strength'] },
      { id: 14, name: 'Crab Walk Race', description: 'Walk like a crab across the room! Race your family!', equipment: [], minAge: 4, maxAge: 12, points: 20, duration: '3 min', difficulty: 'Medium', category: 'strength', tags: ['strength', 'team'] },
      { id: 15, name: 'Caterpillar Push-Ups', description: 'Walk hands out to push-up, do one, walk back up!', equipment: ['yoga_mat'], minAge: 5, maxAge: 12, points: 25, duration: '3 min', difficulty: 'Medium', category: 'strength', tags: ['strength', 'flexibility'] },
      { id: 16, name: 'Ant Lifts', description: 'Ants lift 50x their weight! Do 10 lifts over your head.', equipment: ['weights'], minAge: 6, maxAge: 12, points: 20, duration: '2 min', difficulty: 'Medium', category: 'strength', tags: ['strength'] },
      { id: 17, name: 'Inchworm Walk', description: 'Walk like an inchworm across the yoga mat!', equipment: ['yoga_mat'], minAge: 4, maxAge: 12, points: 20, duration: '3 min', difficulty: 'Medium', category: 'strength', tags: ['strength', 'flexibility'] },
      { id: 18, name: 'Dino Dance Party', description: 'Dance like different dinosaurs to the music!', equipment: ['spotify'], minAge: 3, maxAge: 12, points: 25, duration: '5 min', difficulty: 'Easy', category: 'dance', tags: ['cardio', 'team'] },
      { id: 19, name: 'Freeze Dance Safari', description: 'Dance when music plays, freeze when it stops!', equipment: ['spotify'], minAge: 3, maxAge: 12, points: 25, duration: '5 min', difficulty: 'Easy', category: 'dance', tags: ['cardio', 'team'] },
      { id: 20, name: 'Ballet Butterfly', description: 'Hold the barre and do 10 butterfly pliÃ©s!', equipment: ['barre'], minAge: 4, maxAge: 12, points: 20, duration: '3 min', difficulty: 'Easy', category: 'dance', tags: ['balance', 'flexibility'] },
      { id: 21, name: 'Disco Lights Workout', description: 'Lights off = slow-mo, lights on = fast moves!', equipment: ['spotify', 'lights'], minAge: 4, maxAge: 12, points: 30, duration: '5 min', difficulty: 'Medium', category: 'dance', tags: ['cardio', 'team'] },
      { id: 22, name: 'Jungle Expedition', description: 'Navigate the jungle! Jump, weave, balance!', equipment: ['plyo_6', 'cones', 'balance_beam'], minAge: 5, maxAge: 12, points: 40, duration: '6 min', difficulty: 'Medium', category: 'obstacle', tags: ['jump', 'balance', 'cardio'] },
      { id: 23, name: 'Dinosaur Gauntlet', description: 'Escape the dinosaurs through the obstacle course!', equipment: ['blankets', 'plyo_6', 'cones'], minAge: 4, maxAge: 12, points: 35, duration: '5 min', difficulty: 'Medium', category: 'obstacle', tags: ['cardio', 'strength'] },
      { id: 24, name: 'Bug Obstacle Course', description: 'Move like different bugs through the course!', equipment: ['cones', 'stepping_stones'], minAge: 3, maxAge: 10, points: 30, duration: '5 min', difficulty: 'Easy', category: 'obstacle', tags: ['cardio', 'coordination'] },
      { id: 25, name: 'Mountain Climber Trail', description: 'Climb the mountain! Step up all the plyo boxes!', equipment: ['plyo_6', 'plyo_12', 'plyo_18'], minAge: 6, maxAge: 12, points: 35, duration: '4 min', difficulty: 'Hard', category: 'obstacle', tags: ['jump', 'strength'] },
      { id: 26, name: 'Angry Birds', description: 'Stack yoga blocks and throw balls to knock them down!', equipment: ['foam_balls', 'yoga_blocks'], minAge: 3, maxAge: 12, points: 25, duration: '5 min', difficulty: 'Easy', category: 'target', tags: ['coordination', 'team'] },
      { id: 27, name: 'Cone Bowling', description: 'Set up cones like bowling pins and roll!', equipment: ['cones', 'foam_balls'], minAge: 3, maxAge: 12, points: 20, duration: '5 min', difficulty: 'Easy', category: 'target', tags: ['coordination'] },
      { id: 28, name: 'Pterodactyl Toss', description: 'Fly like a pterodactyl and toss the ball!', equipment: ['foam_balls', 'cones'], minAge: 4, maxAge: 12, points: 25, duration: '4 min', difficulty: 'Medium', category: 'target', tags: ['coordination'] },
      { id: 29, name: 'Zoo Yoga', description: 'Do yoga poses named after animals!', equipment: ['yoga_mat'], minAge: 3, maxAge: 12, points: 20, duration: '5 min', difficulty: 'Easy', category: 'yoga', tags: ['flexibility', 'balance'] },
      { id: 30, name: 'Dinosaur Stretches', description: 'Stretch like dinosaurs! Long neck, T-Rex arms!', equipment: ['yoga_mat'], minAge: 3, maxAge: 12, points: 15, duration: '4 min', difficulty: 'Easy', category: 'yoga', tags: ['flexibility'] },
      { id: 31, name: 'Pretzel Pose Challenge', description: 'Can you twist like a pretzel?', equipment: ['yoga_mat', 'yoga_blocks'], minAge: 5, maxAge: 12, points: 25, duration: '4 min', difficulty: 'Medium', category: 'yoga', tags: ['flexibility', 'balance'] },
      { id: 32, name: 'Partner Yoga Safari', description: 'Do yoga poses with a partner!', equipment: ['yoga_mat'], minAge: 5, maxAge: 12, points: 30, duration: '5 min', difficulty: 'Medium', category: 'yoga', tags: ['flexibility', 'team'] },
      { id: 33, name: 'Hot Lava Floor', description: 'The floor is lava! Use equipment to cross!', equipment: ['stepping_stones', 'balance_beam', 'plyo_6'], minAge: 4, maxAge: 12, points: 30, duration: '5 min', difficulty: 'Medium', category: 'game', tags: ['balance', 'jump', 'team'] },
      { id: 34, name: 'Animal Charades Workout', description: 'Act out animals while exercising!', equipment: [], minAge: 4, maxAge: 12, points: 25, duration: '5 min', difficulty: 'Easy', category: 'game', tags: ['cardio', 'team'] },
      { id: 35, name: 'Simon Says Safari', description: 'Simon Says with animal movements!', equipment: [], minAge: 3, maxAge: 10, points: 20, duration: '5 min', difficulty: 'Easy', category: 'game', tags: ['cardio', 'team'] },
      { id: 36, name: 'Musical Stepping Stones', description: 'Walk on stones, freeze when music stops!', equipment: ['stepping_stones', 'spotify'], minAge: 3, maxAge: 10, points: 25, duration: '5 min', difficulty: 'Easy', category: 'game', tags: ['balance', 'team'] },
      { id: 37, name: 'Blanket Fort Fitness', description: 'Build a fort and exercise in it!', equipment: ['blankets'], minAge: 3, maxAge: 10, points: 30, duration: '10 min', difficulty: 'Easy', category: 'game', tags: ['strength', 'team'] },
      { id: 38, name: 'Treasure Hunt Workout', description: 'Find hidden balls, do jumping jacks each time!', equipment: ['foam_balls'], minAge: 3, maxAge: 10, points: 30, duration: '8 min', difficulty: 'Easy', category: 'game', tags: ['cardio', 'team'] },
      { id: 39, name: 'Sleepy Sloth', description: 'Slow down like a sleepy sloth. Gentle stretches.', equipment: ['yoga_mat'], minAge: 3, maxAge: 12, points: 10, duration: '3 min', difficulty: 'Easy', category: 'cooldown', tags: ['flexibility'] },
      { id: 40, name: 'Hibernating Bear', description: 'Lie down, close eyes, take 10 deep breaths.', equipment: ['yoga_mat', 'blankets'], minAge: 3, maxAge: 12, points: 10, duration: '3 min', difficulty: 'Easy', category: 'cooldown', tags: ['flexibility'] },
      { id: 41, name: 'Butterfly Wings', description: 'Sit in butterfly pose and gently flap.', equipment: ['yoga_mat'], minAge: 3, maxAge: 12, points: 10, duration: '2 min', difficulty: 'Easy', category: 'cooldown', tags: ['flexibility'] },
      { id: 42, name: 'Ninja Warrior Course', description: 'The ultimate challenge! Mega obstacle course!', equipment: ['plyo_6', 'plyo_12', 'balance_beam', 'cones', 'stepping_stones'], minAge: 6, maxAge: 12, points: 50, duration: '8 min', difficulty: 'Hard', category: 'obstacle', tags: ['jump', 'balance', 'strength', 'cardio'] },
      { id: 43, name: 'Bosu Balance Master', description: 'Stand on Bosu and catch balls thrown to you!', equipment: ['bosu', 'foam_balls'], minAge: 6, maxAge: 12, points: 35, duration: '4 min', difficulty: 'Hard', category: 'balance', tags: ['balance', 'coordination', 'team'] },
      { id: 44, name: 'Plyo Power Challenge', description: 'Jump up all three plyo boxes in a row!', equipment: ['plyo_6', 'plyo_12', 'plyo_18'], minAge: 7, maxAge: 12, points: 40, duration: '3 min', difficulty: 'Hard', category: 'jump', tags: ['jump', 'strength', 'cardio'] },
      { id: 45, name: 'Barre Workout', description: 'Hold the barre for leg lifts and pliÃ©s!', equipment: ['barre'], minAge: 5, maxAge: 12, points: 25, duration: '5 min', difficulty: 'Medium', category: 'strength', tags: ['strength', 'balance', 'flexibility'] },
    ];

    const Confetti = ({ active }) => {
      if (!active) return null;
      const pieces = Array.from({ length: 60 }, (_, i) => ({ id: i, left: Math.random() * 100, delay: Math.random() * 2, color: ['#00ffff', '#ff00ff', '#ffff00', '#00ff00', '#ff0080'][Math.floor(Math.random() * 5)], size: Math.random() * 12 + 6 }));
      return (<div style={{ position: 'fixed', top: 0, left: 0, width: '100%', height: '100%', pointerEvents: 'none', zIndex: 1001, overflow: 'hidden' }}>{pieces.map(p => (<div key={p.id} style={{ position: 'absolute', left: `${p.left}%`, top: '-20px', width: `${p.size}px`, height: `${p.size}px`, backgroundColor: p.color, borderRadius: p.id % 2 === 0 ? '50%' : '0', animation: `confettiFall 3s ease-out ${p.delay}s forwards`, boxShadow: `0 0 10px ${p.color}` }} />))}</div>);
    };

    const PointsPopup = ({ points, participantName, onClose }) => {
      useEffect(() => { const t = setTimeout(onClose, 1500); return () => clearTimeout(t); }, [onClose]);
      return (<div style={{ position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', background: 'linear-gradient(135deg, rgba(0,0,0,0.95) 0%, rgba(20,20,40,0.95) 100%)', border: '3px solid #00ffff', borderRadius: '20px', padding: '40px 60px', textAlign: 'center', animation: 'popIn 0.3s ease-out', zIndex: 1002, boxShadow: '0 0 40px #00ffff' }}><div style={{ fontSize: '56px', marginBottom: '12px', animation: 'float 1s ease-in-out infinite' }}>ğŸ‰</div><div style={{ fontSize: '20px', marginBottom: '8px', color: '#00ffff', fontFamily: 'Orbitron, sans-serif' }}>{participantName}</div><div style={{ fontSize: '42px', fontWeight: 'bold', color: '#ffff00', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #ffff00' }}>+{points} XP!</div></div>);
    };

    const BadgePopup = ({ badge, onClose }) => {
      if (!badge) return null;
      return (<div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.9)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1002 }} onClick={onClose}><div style={{ background: 'linear-gradient(135deg, rgba(0,20,40,0.98) 0%, rgba(20,0,40,0.98) 100%)', border: '3px solid #ff00ff', borderRadius: '24px', padding: '40px', textAlign: 'center', animation: 'popIn 0.5s ease-out', maxWidth: '320px', boxShadow: '0 0 60px #ff00ff' }}><div style={{ fontSize: '80px', marginBottom: '16px', filter: 'drop-shadow(0 0 20px #ff00ff)' }}>{badge.emoji}</div><h2 style={{ color: '#ff00ff', margin: '0 0 8px 0', fontSize: '24px', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #ff00ff' }}>BADGE UNLOCKED!</h2><h3 style={{ color: '#00ffff', margin: '0 0 16px 0', fontSize: '28px', fontFamily: 'Orbitron, sans-serif' }}>{badge.name}</h3><p style={{ color: 'rgba(255,255,255,0.9)', margin: 0, fontSize: '16px' }}>{badge.description}</p><button onClick={onClose} style={{ marginTop: '24px', padding: '14px 36px', fontSize: '16px', fontWeight: 'bold', border: '2px solid #00ffff', borderRadius: '25px', background: 'transparent', color: '#00ffff', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif' }}>AWESOME!</button></div></div>);
    };

    const LevelUpPopup = ({ level, onClose }) => {
      if (!level) return null;
      return (<div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.9)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1002 }} onClick={onClose}><div style={{ background: 'linear-gradient(135deg, rgba(40,20,0,0.98) 0%, rgba(40,0,20,0.98) 100%)', border: '3px solid #ffff00', borderRadius: '24px', padding: '40px', textAlign: 'center', animation: 'popIn 0.5s ease-out', maxWidth: '320px', boxShadow: '0 0 60px #ffff00' }}><div style={{ fontSize: '80px', marginBottom: '16px', filter: 'drop-shadow(0 0 20px #ffff00)', animation: 'float 1s ease-in-out infinite' }}>{level.emoji}</div><h2 style={{ color: '#ffff00', margin: '0 0 8px 0', fontSize: '28px', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #ffff00' }}>LEVEL UP!</h2><h3 style={{ color: '#00ffff', margin: '0 0 16px 0', fontSize: '32px', fontFamily: 'Orbitron, sans-serif' }}>Level {level.level}</h3><p style={{ color: '#ff00ff', margin: 0, fontSize: '22px', fontFamily: 'Orbitron, sans-serif' }}>{level.name}</p><button onClick={onClose} style={{ marginTop: '24px', padding: '14px 36px', fontSize: '16px', fontWeight: 'bold', border: '2px solid #ffff00', borderRadius: '25px', background: 'transparent', color: '#ffff00', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif' }}>LET'S GO!</button></div></div>);
    };

    const SpinningWheel = ({ activities, onComplete, onClose }) => {
      const [spinning, setSpinning] = useState(true);
      const [currentIndex, setCurrentIndex] = useState(0);
      const [selectedActivity, setSelectedActivity] = useState(null);
      const [showResult, setShowResult] = useState(false);

      useEffect(() => {
        if (!spinning) return;
        let speed = 50, iterations = 0;
        const maxIterations = 30 + Math.floor(Math.random() * 20);
        const spin = () => {
          iterations++;
          setCurrentIndex(prev => (prev + 1) % activities.length);
          if (iterations >= maxIterations) { setSpinning(false); const finalIndex = Math.floor(Math.random() * activities.length); setCurrentIndex(finalIndex); setSelectedActivity(activities[finalIndex]); setTimeout(() => setShowResult(true), 500); return; }
          speed = Math.min(speed + (iterations > maxIterations - 10 ? 30 : 5), 400);
          setTimeout(spin, speed);
        };
        const timer = setTimeout(spin, speed);
        return () => clearTimeout(timer);
      }, []);

      const visibleActivities = [];
      for (let i = -2; i <= 2; i++) { const idx = (currentIndex + i + activities.length) % activities.length; visibleActivities.push({ activity: activities[idx], offset: i }); }

      return (<div style={{ position: 'fixed', top: 0, left: 0, right: 0, bottom: 0, backgroundColor: 'rgba(0,0,0,0.95)', display: 'flex', alignItems: 'center', justifyContent: 'center', zIndex: 1002, flexDirection: 'column' }}>
        <div style={{ textAlign: 'center', marginBottom: '20px' }}><h2 style={{ color: '#00ffff', fontSize: '32px', margin: 0, fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #00ffff' }}>{spinning ? 'ğŸ² SCANNING...' : 'ğŸ¯ MISSION SELECTED!'}</h2></div>
        <div style={{ position: 'relative', height: '300px', width: '100%', maxWidth: '420px', overflow: 'hidden' }}>
          <div style={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', width: '88%', height: '70px', border: '3px solid #00ffff', borderRadius: '12px', zIndex: 2, pointerEvents: 'none', boxShadow: '0 0 30px #00ffff', animation: 'neonPulse 1s ease-in-out infinite' }} />
          <div style={{ position: 'absolute', top: '50%', left: '50%', transform: 'translate(-50%, -50%)', width: '100%' }}>{visibleActivities.map(({ activity, offset }, idx) => (<div key={idx} style={{ position: 'absolute', left: '50%', width: '88%', transform: `translateX(-50%) translateY(${offset * 72}px)`, transition: spinning ? 'none' : 'all 0.3s ease-out', opacity: offset === 0 ? 1 : 0.3, padding: '14px 20px', background: offset === 0 ? 'linear-gradient(135deg, rgba(0,255,255,0.2) 0%, rgba(255,0,255,0.2) 100%)' : 'rgba(255,255,255,0.05)', border: offset === 0 ? '2px solid #ff00ff' : '1px solid rgba(255,255,255,0.1)', borderRadius: '12px', textAlign: 'center' }}><div style={{ color: offset === 0 ? '#fff' : '#888', fontWeight: 'bold', fontSize: offset === 0 ? '18px' : '14px' }}>{activity.name}</div>{offset === 0 && (<div style={{ color: '#00ffff', fontSize: '13px', marginTop: '4px', fontFamily: 'Orbitron, sans-serif' }}>+{activity.points} XP â€¢ {activity.difficulty}</div>)}</div>))}</div>
        </div>
        {showResult && (<div style={{ marginTop: '30px', display: 'flex', gap: '16px' }}><button onClick={() => onComplete(selectedActivity)} className="arcade-btn" style={{ padding: '16px 32px', fontSize: '16px', border: '2px solid #00ff00', borderRadius: '30px', background: 'transparent', color: '#00ff00', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 20px rgba(0,255,0,0.3)' }}>LAUNCH! ğŸš€</button><button onClick={onClose} className="arcade-btn" style={{ padding: '16px 32px', fontSize: '16px', border: '2px solid #ff00ff', borderRadius: '30px', background: 'transparent', color: '#ff00ff', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 20px rgba(255,0,255,0.3)' }}>RESCAN ğŸ²</button></div>)}
      </div>);
    };

    const ActivityCard = ({ activity, isFavorite, onToggleFavorite, onComplete, availableEquipment, participants, activityNotes, onUpdateNote }) => {
      const [showNoteInput, setShowNoteInput] = useState(false);
      const [noteText, setNoteText] = useState(activityNotes[activity.id] || '');
      const hasAllEquipment = activity.equipment.every(eq => availableEquipment.includes(eq));
      const missingEquipment = activity.equipment.filter(eq => !availableEquipment.includes(eq));
      const difficultyColors = { 'Easy': '#00ff00', 'Medium': '#ffff00', 'Hard': '#ff0000' };
      const handleSaveNote = () => { onUpdateNote(activity.id, noteText); setShowNoteInput(false); };

      return (<div className="neon-card" style={{ borderRadius: '16px', padding: '20px', marginBottom: '16px', opacity: hasAllEquipment ? 1 : 0.5, borderColor: hasAllEquipment ? '#00ffff' : '#444' }}>
        <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'flex-start', marginBottom: '12px' }}>
          <div><h3 style={{ margin: '0 0 8px 0', fontSize: '20px', color: '#fff', fontFamily: 'Orbitron, sans-serif' }}>{activity.name}</h3><div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}><span style={{ padding: '4px 12px', borderRadius: '12px', fontSize: '12px', fontWeight: 'bold', backgroundColor: 'transparent', color: difficultyColors[activity.difficulty], border: `1px solid ${difficultyColors[activity.difficulty]}`, fontFamily: 'Orbitron, sans-serif' }}>{activity.difficulty}</span><span style={{ padding: '4px 12px', borderRadius: '12px', fontSize: '12px', backgroundColor: 'rgba(255,255,255,0.1)', color: '#aaa' }}>{activity.duration}</span><span style={{ padding: '4px 12px', borderRadius: '12px', fontSize: '12px', backgroundColor: 'transparent', color: '#00ffff', border: '1px solid #00ffff', fontFamily: 'Orbitron, sans-serif', fontWeight: 'bold' }}>+{activity.points} XP</span></div></div>
          <button onClick={() => onToggleFavorite(activity.id)} style={{ background: 'none', border: 'none', fontSize: '28px', cursor: 'pointer', padding: '4px', filter: isFavorite ? 'drop-shadow(0 0 10px #ff0080)' : 'none' }}>{isFavorite ? 'ğŸ’–' : 'ğŸ–¤'}</button>
        </div>
        <p style={{ color: '#bbb', marginBottom: '12px', lineHeight: '1.5' }}>{activity.description}</p>
        {activity.equipment.length > 0 && (<div style={{ marginBottom: '12px' }}><span style={{ fontSize: '14px', color: '#888' }}>Equipment: </span>{activity.equipment.map(eq => { const equipment = EQUIPMENT_OPTIONS.find(e => e.id === eq); const isMissing = missingEquipment.includes(eq); return <span key={eq} style={{ display: 'inline-block', padding: '4px 8px', margin: '2px 4px', borderRadius: '8px', fontSize: '12px', backgroundColor: isMissing ? 'rgba(255,0,0,0.2)' : 'rgba(0,255,255,0.1)', color: isMissing ? '#ff4444' : '#00ffff', border: `1px solid ${isMissing ? '#ff4444' : '#00ffff'}` }}>{equipment?.emoji} {equipment?.name}</span>; })}</div>)}
        <div style={{ fontSize: '14px', color: '#666', marginBottom: '16px' }}>Ages {activity.minAge}-{activity.maxAge}</div>
        {hasAllEquipment && participants.length > 0 && (<div style={{ marginBottom: '16px' }}><div style={{ fontSize: '14px', color: '#00ffff', marginBottom: '8px', fontFamily: 'Orbitron, sans-serif' }}>TAP TO COMPLETE:</div><div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap' }}>{participants.map(p => { const avatar = AVATARS.find(a => a.id === p.avatar); const color = COLOR_OPTIONS.find(c => c.id === p.color) || COLOR_OPTIONS[0]; return (<button key={p.id} onClick={() => onComplete(activity, p.id)} style={{ padding: '10px 16px', borderRadius: '25px', border: `2px solid ${color.primary}`, background: 'transparent', color: color.primary, fontWeight: 'bold', fontSize: '14px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px', boxShadow: color.glow }}><span style={{ filter: `drop-shadow(0 0 5px ${color.primary})` }}>{avatar?.emoji}</span><span>{p.name}</span></button>); })}{participants.length > 1 && (<button onClick={() => onComplete(activity, 'ALL')} style={{ padding: '10px 20px', borderRadius: '25px', border: '2px solid #ffff00', background: 'transparent', color: '#ffff00', fontWeight: 'bold', fontSize: '14px', cursor: 'pointer', display: 'flex', alignItems: 'center', gap: '6px', boxShadow: '0 0 20px rgba(255,255,0,0.3)', fontFamily: 'Orbitron, sans-serif' }}><span>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦</span><span>ALL</span></button>)}</div></div>)}
        {!hasAllEquipment && (<div style={{ padding: '12px', borderRadius: '8px', backgroundColor: 'rgba(255,0,0,0.1)', color: '#ff4444', fontSize: '14px', marginBottom: '16px', border: '1px solid #ff4444' }}>âš ï¸ Missing equipment - enable in Settings</div>)}
        <div style={{ borderTop: '1px solid #333', paddingTop: '12px' }}>{!showNoteInput ? (<button onClick={() => setShowNoteInput(true)} style={{ background: 'none', border: '1px dashed #444', borderRadius: '8px', padding: '8px 16px', color: '#666', fontSize: '14px', cursor: 'pointer', width: '100%', textAlign: 'left' }}>{activityNotes[activity.id] ? `ğŸ“ ${activityNotes[activity.id]}` : 'ğŸ’¡ Add suggestion or note...'}</button>) : (<div><textarea value={noteText} onChange={(e) => setNoteText(e.target.value)} placeholder="Add your suggestions..." style={{ width: '100%', padding: '12px', borderRadius: '8px', border: '2px solid #00ffff', fontSize: '14px', minHeight: '80px', resize: 'vertical', boxSizing: 'border-box', background: 'rgba(0,0,0,0.5)', color: '#fff' }} /><div style={{ display: 'flex', gap: '8px', marginTop: '8px' }}><button onClick={handleSaveNote} style={{ padding: '8px 16px', borderRadius: '8px', border: '2px solid #00ffff', background: 'transparent', color: '#00ffff', fontWeight: 'bold', cursor: 'pointer' }}>Save</button><button onClick={() => { setShowNoteInput(false); setNoteText(activityNotes[activity.id] || ''); }} style={{ padding: '8px 16px', borderRadius: '8px', border: '1px solid #444', background: 'transparent', color: '#888', cursor: 'pointer' }}>Cancel</button></div></div>)}</div>
      </div>);
    };

    const ParticipantCard = ({ participant, onClick }) => {
      const avatar = AVATARS.find(a => a.id === participant.avatar);
      const color = COLOR_OPTIONS.find(c => c.id === participant.color) || COLOR_OPTIONS[0];
      const currentLevel = LEVELS.filter(l => participant.xp >= l.minXP).pop();
      const nextLevel = LEVELS.find(l => l.minXP > participant.xp);
      const progressToNext = nextLevel ? ((participant.xp - currentLevel.minXP) / (nextLevel.minXP - currentLevel.minXP)) * 100 : 100;

      return (<div onClick={onClick} style={{ background: 'linear-gradient(135deg, rgba(10,10,30,0.95) 0%, rgba(20,20,50,0.95) 100%)', border: `2px solid ${color.primary}`, borderRadius: '20px', padding: '20px', color: 'white', cursor: 'pointer', transition: 'all 0.3s ease', boxShadow: `0 0 30px ${color.primary}40` }} onMouseOver={(e) => { e.currentTarget.style.transform = 'scale(1.02)'; e.currentTarget.style.boxShadow = `0 0 50px ${color.primary}60`; }} onMouseOut={(e) => { e.currentTarget.style.transform = 'scale(1)'; e.currentTarget.style.boxShadow = `0 0 30px ${color.primary}40`; }}>
        <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px' }}><div style={{ width: '65px', height: '65px', borderRadius: '50%', backgroundColor: `${color.primary}20`, border: `2px solid ${color.primary}`, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '34px', marginRight: '16px', boxShadow: `0 0 20px ${color.primary}40`, animation: 'float 3s ease-in-out infinite' }}>{avatar?.emoji}</div><div><h3 style={{ margin: '0 0 4px 0', fontSize: '22px', fontFamily: 'Orbitron, sans-serif', color: color.primary, textShadow: `0 0 10px ${color.primary}` }}>{participant.name}</h3><div style={{ fontSize: '14px', color: '#aaa' }}>{currentLevel?.emoji} {currentLevel?.name}</div></div></div>
        <div style={{ marginBottom: '8px' }}><div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '12px', marginBottom: '6px', fontFamily: 'Orbitron, sans-serif' }}><span style={{ color: color.primary }}>{participant.xp} XP</span>{nextLevel && <span style={{ color: '#666' }}>{nextLevel.minXP} XP</span>}</div><div style={{ height: '8px', backgroundColor: 'rgba(255,255,255,0.1)', borderRadius: '4px', overflow: 'hidden', border: `1px solid ${color.primary}40` }}><div style={{ height: '100%', width: `${progressToNext}%`, background: color.gradient, borderRadius: '4px', transition: 'width 0.5s ease-out', boxShadow: `0 0 10px ${color.primary}` }} /></div></div>
        <div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '13px', color: '#888' }}><span>ğŸ† {participant.completedActivities?.length || 0} completed</span><span>ğŸ… {(participant.earnedBadges?.length || 0) + (participant.avatarBadges?.length || 0)} badges</span></div>
      </div>);
    };

    const ParticipantEditor = ({ participant, onSave, onCancel, onDelete, isNew }) => {
      const [name, setName] = useState(participant?.name || '');
      const [age, setAge] = useState(participant?.age?.toString() || '');
      const [avatar, setAvatar] = useState(participant?.avatar || 'trex');
      const [color, setColor] = useState(participant?.color || 'cyan');

      return (<div className="neon-card" style={{ borderRadius: '16px', padding: '20px', marginBottom: '16px' }}>
        <h3 style={{ margin: '0 0 16px 0', color: '#00ffff', fontFamily: 'Orbitron, sans-serif' }}>{isNew ? 'NEW PILOT' : 'EDIT PILOT'}</h3>
        <div style={{ marginBottom: '16px' }}><label style={{ display: 'block', marginBottom: '6px', color: '#888', fontFamily: 'Orbitron, sans-serif', fontSize: '12px' }}>NAME</label><input type="text" value={name} onChange={(e) => setName(e.target.value)} placeholder="Enter name" style={{ width: '100%', padding: '12px', borderRadius: '8px', border: '2px solid #00ffff', fontSize: '16px', boxSizing: 'border-box', background: 'rgba(0,0,0,0.5)', color: '#fff' }} /></div>
        <div style={{ marginBottom: '16px' }}><label style={{ display: 'block', marginBottom: '6px', color: '#888', fontFamily: 'Orbitron, sans-serif', fontSize: '12px' }}>AGE</label><input type="number" value={age} onChange={(e) => setAge(e.target.value)} placeholder="Age" min="1" max="18" style={{ width: '100%', padding: '12px', borderRadius: '8px', border: '2px solid #00ffff', fontSize: '16px', boxSizing: 'border-box', background: 'rgba(0,0,0,0.5)', color: '#fff' }} /></div>
        <div style={{ marginBottom: '16px' }}><label style={{ display: 'block', marginBottom: '6px', color: '#888', fontFamily: 'Orbitron, sans-serif', fontSize: '12px' }}>AVATAR</label><div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>{AVATARS.map(a => (<button key={a.id} onClick={() => setAvatar(a.id)} style={{ width: '52px', height: '52px', borderRadius: '12px', border: avatar === a.id ? '3px solid #00ffff' : '2px solid #333', background: avatar === a.id ? 'rgba(0,255,255,0.1)' : 'rgba(0,0,0,0.3)', fontSize: '28px', cursor: 'pointer', boxShadow: avatar === a.id ? '0 0 15px #00ffff' : 'none' }}>{a.emoji}</button>))}</div></div>
        <div style={{ marginBottom: '20px' }}><label style={{ display: 'block', marginBottom: '6px', color: '#888', fontFamily: 'Orbitron, sans-serif', fontSize: '12px' }}>COLOR THEME</label><div style={{ display: 'flex', flexWrap: 'wrap', gap: '8px' }}>{COLOR_OPTIONS.map(c => (<button key={c.id} onClick={() => setColor(c.id)} style={{ width: '52px', height: '52px', borderRadius: '12px', border: color === c.id ? '3px solid #fff' : '2px solid transparent', background: c.gradient, cursor: 'pointer', boxShadow: color === c.id ? `0 0 20px ${c.primary}` : c.glow }} />))}</div></div>
        <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}><button onClick={() => onSave({ ...participant, name, age: parseInt(age), avatar, color })} disabled={!name || !age} style={{ padding: '12px 24px', borderRadius: '8px', border: '2px solid #00ff00', background: 'transparent', color: name && age ? '#00ff00' : '#444', fontWeight: 'bold', fontSize: '14px', cursor: name && age ? 'pointer' : 'not-allowed', fontFamily: 'Orbitron, sans-serif', boxShadow: name && age ? '0 0 15px rgba(0,255,0,0.3)' : 'none' }}>{isNew ? 'ADD PILOT' : 'SAVE'}</button><button onClick={onCancel} style={{ padding: '12px 24px', borderRadius: '8px', border: '1px solid #444', background: 'transparent', color: '#888', fontWeight: 'bold', fontSize: '14px', cursor: 'pointer' }}>CANCEL</button>{!isNew && (<button onClick={() => onDelete(participant.id)} style={{ padding: '12px 24px', borderRadius: '8px', border: '2px solid #ff0000', background: 'transparent', color: '#ff0000', fontWeight: 'bold', fontSize: '14px', cursor: 'pointer', marginLeft: 'auto', fontFamily: 'Orbitron, sans-serif' }}>DELETE</button>)}</div>
      </div>);
    };

    const Settings = ({ participants, equipment, activityNotes, onSaveParticipant, onDeleteParticipant, onToggleEquipment }) => {
      const [editingId, setEditingId] = useState(null);
      const [showAddNew, setShowAddNew] = useState(false);
      const handleSave = (participantData) => { onSaveParticipant(participantData); setEditingId(null); setShowAddNew(false); };
      const activitiesWithNotes = ACTIVITY_LIBRARY.filter(a => activityNotes[a.id]);

      return (<div>
        <h1 style={{ fontSize: '28px', margin: '0 0 24px 0', color: '#00ffff', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #00ffff' }}>âš™ï¸ COMMAND CENTER</h1>
        <div className="neon-card" style={{ borderRadius: '16px', padding: '20px', marginBottom: '24px' }}><h2 style={{ margin: '0 0 16px 0', color: '#ff00ff', fontFamily: 'Orbitron, sans-serif' }}>ğŸ‘¥ PILOTS ({participants.length}/4)</h2>{participants.map(p => { if (editingId === p.id) { return <ParticipantEditor key={p.id} participant={p} onSave={handleSave} onCancel={() => setEditingId(null)} onDelete={(id) => { onDeleteParticipant(id); setEditingId(null); }} isNew={false} />; } const avatar = AVATARS.find(a => a.id === p.avatar); const color = COLOR_OPTIONS.find(c => c.id === p.color) || COLOR_OPTIONS[0]; return (<div key={p.id} style={{ display: 'flex', alignItems: 'center', justifyContent: 'space-between', padding: '16px', background: 'rgba(0,0,0,0.3)', borderRadius: '12px', marginBottom: '8px', border: `2px solid ${color.primary}`, boxShadow: `0 0 15px ${color.primary}30` }}><div style={{ display: 'flex', alignItems: 'center', gap: '12px' }}><span style={{ fontSize: '36px', filter: `drop-shadow(0 0 10px ${color.primary})` }}>{avatar?.emoji}</span><div><div style={{ fontWeight: 'bold', fontSize: '18px', color: color.primary, fontFamily: 'Orbitron, sans-serif' }}>{p.name}</div><div style={{ fontSize: '14px', color: '#888' }}>Age {p.age} â€¢ {p.xp} XP</div></div></div><button onClick={() => setEditingId(p.id)} style={{ padding: '8px 20px', borderRadius: '8px', border: `1px solid ${color.primary}`, background: 'transparent', color: color.primary, fontWeight: 'bold', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif' }}>âœï¸ EDIT</button></div>); })}{showAddNew ? (<ParticipantEditor participant={{ id: Date.now().toString(), xp: 0, completedActivities: [], earnedBadges: [], avatarBadges: [] }} onSave={handleSave} onCancel={() => setShowAddNew(false)} onDelete={() => {}} isNew={true} />) : (participants.length < 4 && (<button onClick={() => setShowAddNew(true)} style={{ width: '100%', padding: '16px', borderRadius: '12px', border: '2px dashed #00ffff', background: 'transparent', color: '#00ffff', fontWeight: 'bold', fontSize: '16px', cursor: 'pointer', marginTop: '8px', fontFamily: 'Orbitron, sans-serif' }}>+ ADD PILOT</button>))}</div>
        <div className="neon-card" style={{ borderRadius: '16px', padding: '20px', marginBottom: '24px' }}><h2 style={{ margin: '0 0 16px 0', color: '#ffff00', fontFamily: 'Orbitron, sans-serif' }}>ğŸ‹ï¸ EQUIPMENT BAY</h2><p style={{ color: '#888', marginBottom: '16px', fontSize: '14px' }}>Select available equipment to unlock missions.</p><div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(200px, 1fr))', gap: '8px' }}>{EQUIPMENT_OPTIONS.map(eq => (<label key={eq.id} style={{ display: 'flex', alignItems: 'center', gap: '12px', padding: '12px', backgroundColor: equipment.includes(eq.id) ? 'rgba(0,255,0,0.1)' : 'rgba(0,0,0,0.3)', borderRadius: '12px', cursor: 'pointer', border: equipment.includes(eq.id) ? '1px solid #00ff00' : '1px solid #333' }}><input type="checkbox" checked={equipment.includes(eq.id)} onChange={() => onToggleEquipment(eq.id)} style={{ width: '20px', height: '20px', accentColor: '#00ff00' }} /><span style={{ fontSize: '20px' }}>{eq.emoji}</span><span style={{ color: equipment.includes(eq.id) ? '#00ff00' : '#888' }}>{eq.name}</span></label>))}</div></div>
        <div className="neon-card" style={{ borderRadius: '16px', padding: '20px' }}><h2 style={{ margin: '0 0 16px 0', color: '#ff8000', fontFamily: 'Orbitron, sans-serif' }}>ğŸ“ MISSION NOTES</h2><p style={{ color: '#888', marginBottom: '16px', fontSize: '14px' }}>Suggestions and notes for activities.</p>{activitiesWithNotes.length === 0 ? (<div style={{ padding: '20px', textAlign: 'center', color: '#666', backgroundColor: 'rgba(0,0,0,0.3)', borderRadius: '12px' }}>No notes yet. Add suggestions on individual activities!</div>) : (<div>{activitiesWithNotes.map(activity => (<div key={activity.id} style={{ padding: '16px', backgroundColor: 'rgba(0,0,0,0.3)', borderRadius: '12px', marginBottom: '8px', border: '1px solid #333' }}><div style={{ fontWeight: 'bold', color: '#00ffff', marginBottom: '4px', fontFamily: 'Orbitron, sans-serif' }}>{activity.name}</div><div style={{ color: '#aaa', fontSize: '14px', whiteSpace: 'pre-wrap' }}>ğŸ’¡ {activityNotes[activity.id]}</div></div>))}</div>)}</div>
      </div>);
    };

    function App() {
      const [view, setView] = useState('dashboard');
      const [selectedParticipant, setSelectedParticipant] = useState(null);
      const [showConfetti, setShowConfetti] = useState(false);
      const [newBadge, setNewBadge] = useState(null);
      const [newLevel, setNewLevel] = useState(null);
      const [pointsPopup, setPointsPopup] = useState(null);
      const [showWheel, setShowWheel] = useState(false);
      const [activityFilter, setActivityFilter] = useState('all');
      const [searchQuery, setSearchQuery] = useState('');

      const [participants, setParticipants] = useState(() => { const saved = localStorage.getItem('gymAdventure_participants'); return saved ? JSON.parse(saved) : []; });
      const [equipment, setEquipment] = useState(() => { const saved = localStorage.getItem('gymAdventure_equipment'); return saved ? JSON.parse(saved) : []; });
      const [favorites, setFavorites] = useState(() => { const saved = localStorage.getItem('gymAdventure_favorites'); return saved ? JSON.parse(saved) : []; });
      const [completionHistory, setCompletionHistory] = useState(() => { const saved = localStorage.getItem('gymAdventure_history'); return saved ? JSON.parse(saved) : []; });
      const [activityNotes, setActivityNotes] = useState(() => { const saved = localStorage.getItem('gymAdventure_notes'); return saved ? JSON.parse(saved) : {}; });

      useEffect(() => { localStorage.setItem('gymAdventure_participants', JSON.stringify(participants)); }, [participants]);
      useEffect(() => { localStorage.setItem('gymAdventure_equipment', JSON.stringify(equipment)); }, [equipment]);
      useEffect(() => { localStorage.setItem('gymAdventure_favorites', JSON.stringify(favorites)); }, [favorites]);
      useEffect(() => { localStorage.setItem('gymAdventure_history', JSON.stringify(completionHistory)); }, [completionHistory]);
      useEffect(() => { localStorage.setItem('gymAdventure_notes', JSON.stringify(activityNotes)); }, [activityNotes]);

      const getParticipantStats = (participant) => { const completed = participant.completedActivities || []; return { totalCompleted: completed.length, totalPoints: participant.xp || 0, balanceCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'balance').length, jumpCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'jump').length, teamCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.tags?.includes('team')).length, strengthCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'strength').length, danceCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'dance').length, yogaCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'yoga').length, obstacleCompleted: completed.filter(c => ACTIVITY_LIBRARY.find(a => a.id === c.activityId)?.category === 'obstacle').length, favoritesCount: favorites.length, uniqueActivities: new Set(completed.map(c => c.activityId)).size, uniqueDays: new Set(completed.map(c => new Date(c.date).toDateString())).size }; };
      const checkBadges = (participant) => { const stats = getParticipantStats(participant); const earnedBadges = participant.earnedBadges || []; for (const badge of BADGES) { if (!earnedBadges.includes(badge.id) && badge.condition(stats)) return badge; } return null; };
      const checkAvatarBadges = (participant) => { const avatarBadges = participant.avatarBadges || []; const avatarId = participant.avatar; const completedCount = (participant.completedActivities || []).length; for (const badge of AVATAR_BADGES) { if (badge.avatarId === avatarId && !avatarBadges.includes(badge.id) && completedCount >= badge.threshold) { return badge; } } return null; };
      const toggleFavorite = (activityId) => setFavorites(prev => prev.includes(activityId) ? prev.filter(id => id !== activityId) : [...prev, activityId]);

      const completeActivity = (activity, participantIdOrAll) => {
        const participantIds = participantIdOrAll === 'ALL' ? participants.map(p => p.id) : [participantIdOrAll];
        let totalPoints = 0; let completedNames = [];
        participantIds.forEach(participantId => {
          const participant = participants.find(p => p.id === participantId); if (!participant) return;
          const previousLevel = LEVELS.filter(l => participant.xp >= l.minXP).pop();
          const updatedParticipant = { ...participant, xp: (participant.xp || 0) + activity.points, completedActivities: [...(participant.completedActivities || []), { activityId: activity.id, date: new Date().toISOString(), points: activity.points }] };
          const newLevelData = LEVELS.filter(l => updatedParticipant.xp >= l.minXP).pop();
          if (newLevelData.level > previousLevel.level) { setTimeout(() => setNewLevel(newLevelData), participantIds.length > 1 ? 2000 : 1500); }
          const badge = checkBadges(updatedParticipant); if (badge) { updatedParticipant.earnedBadges = [...(updatedParticipant.earnedBadges || []), badge.id]; setTimeout(() => setNewBadge(badge), newLevelData.level > previousLevel.level ? 4000 : 2500); }
          const avatarBadge = checkAvatarBadges(updatedParticipant); if (avatarBadge) { updatedParticipant.avatarBadges = [...(updatedParticipant.avatarBadges || []), avatarBadge.id]; setTimeout(() => setNewBadge(avatarBadge), badge ? 5500 : (newLevelData.level > previousLevel.level ? 4000 : 2500)); }
          setParticipants(prev => prev.map(p => p.id === participantId ? updatedParticipant : p));
          setCompletionHistory(prev => [...prev, { participantId, participantName: participant.name, activityId: activity.id, activityName: activity.name, points: activity.points, date: new Date().toISOString() }]);
          totalPoints += activity.points; completedNames.push(participant.name);
        });
        setPointsPopup({ points: totalPoints, participantName: participantIdOrAll === 'ALL' ? 'Everyone' : completedNames[0] });
        setShowConfetti(true); setTimeout(() => setShowConfetti(false), 3000);
      };

      const saveParticipant = (participantData) => { const existing = participants.find(p => p.id === participantData.id); if (existing) { setParticipants(prev => prev.map(p => p.id === participantData.id ? { ...p, ...participantData } : p)); } else { if (participants.length >= 4) return; setParticipants(prev => [...prev, participantData]); } };
      const deleteParticipant = (id) => setParticipants(prev => prev.filter(p => p.id !== id));
      const toggleEquipment = (equipmentId) => setEquipment(prev => prev.includes(equipmentId) ? prev.filter(id => id !== equipmentId) : [...prev, equipmentId]);
      const updateActivityNote = (activityId, note) => { setActivityNotes(prev => { if (!note || note.trim() === '') { const { [activityId]: removed, ...rest } = prev; return rest; } return { ...prev, [activityId]: note }; }); };
      const getEligibleActivities = () => ACTIVITY_LIBRARY.filter(a => a.equipment.every(eq => equipment.includes(eq)) && (participants.length === 0 || participants.some(p => p.age >= a.minAge && p.age <= a.maxAge)));
      const getFilteredActivities = () => { let filtered = ACTIVITY_LIBRARY; if (activityFilter !== 'all') filtered = filtered.filter(a => a.category === activityFilter); if (searchQuery) { const query = searchQuery.toLowerCase(); filtered = filtered.filter(a => a.name.toLowerCase().includes(query) || a.description.toLowerCase().includes(query)); } filtered.sort((a, b) => { const aHas = a.equipment.every(eq => equipment.includes(eq)); const bHas = b.equipment.every(eq => equipment.includes(eq)); return aHas === bHas ? 0 : aHas ? -1 : 1; }); return filtered; };

      const renderDashboard = () => (<div>
        <div style={{ textAlign: 'center', marginBottom: '40px' }}><h1 style={{ fontSize: '38px', margin: '0 0 8px 0', fontFamily: 'Orbitron, sans-serif', background: 'linear-gradient(90deg, #00ffff, #ff00ff, #ffff00, #00ffff)', backgroundSize: '300% 100%', WebkitBackgroundClip: 'text', WebkitTextFillColor: 'transparent', animation: 'shimmer 3s linear infinite' }}>ğŸ¦– HOME GYM ADVENTURE ğŸ¦‹</h1><p style={{ color: '#888', margin: 0, fontFamily: 'Orbitron, sans-serif', fontSize: '14px', letterSpacing: '3px' }}>SPACE â€¢ DINOS â€¢ FITNESS</p></div>
        {participants.length === 0 ? (<div className="neon-card" style={{ textAlign: 'center', padding: '50px', borderRadius: '20px', marginBottom: '24px' }}><div style={{ fontSize: '80px', marginBottom: '20px', animation: 'float 2s ease-in-out infinite' }}>ğŸ¦•</div><h2 style={{ color: '#00ffff', marginBottom: '12px', fontFamily: 'Orbitron, sans-serif' }}>NO PILOTS DETECTED!</h2><p style={{ color: '#888', marginBottom: '28px' }}>Register pilots in Command Center to begin.</p><button onClick={() => setView('settings')} className="arcade-btn" style={{ padding: '18px 40px', fontSize: '16px', border: '2px solid #00ffff', borderRadius: '30px', background: 'transparent', color: '#00ffff', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 30px rgba(0,255,255,0.3)' }}>COMMAND CENTER âš™ï¸</button></div>) : (<><div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fit, minmax(280px, 1fr))', gap: '16px', marginBottom: '32px' }}>{participants.map(p => <ParticipantCard key={p.id} participant={p} onClick={() => { setSelectedParticipant(p); setView('participant'); }} />)}</div><button onClick={() => setView('activities')} className="arcade-btn" style={{ width: '100%', padding: '22px', fontSize: '20px', border: '3px solid #ff00ff', borderRadius: '16px', background: 'linear-gradient(135deg, rgba(255,0,255,0.1) 0%, rgba(255,0,128,0.1) 100%)', color: '#ff00ff', cursor: 'pointer', marginBottom: '16px', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 40px rgba(255,0,255,0.3)', letterSpacing: '3px' }}>ğŸ¯ LAUNCH MISSION!</button><div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }}><button onClick={() => { const eligible = getEligibleActivities(); if (eligible.length > 0) { setShowWheel(true); } else { alert('No missions available!'); } }} className="arcade-btn" style={{ padding: '18px', fontSize: '15px', border: '2px solid #00ffff', borderRadius: '12px', background: 'transparent', color: '#00ffff', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 20px rgba(0,255,255,0.2)' }}>ğŸ² RANDOM</button><button onClick={() => setView('favorites')} className="arcade-btn" style={{ padding: '18px', fontSize: '15px', border: '2px solid #ff0080', borderRadius: '12px', background: 'transparent', color: '#ff0080', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 20px rgba(255,0,128,0.2)' }}>ğŸ’– FAVORITES ({favorites.length})</button></div></>)}
        {completionHistory.length > 0 && (<div style={{ marginTop: '32px' }}><h2 style={{ color: '#00ffff', marginBottom: '16px', fontFamily: 'Orbitron, sans-serif' }}>ğŸ“œ MISSION LOG</h2><div className="neon-card" style={{ borderRadius: '16px', overflow: 'hidden' }}>{completionHistory.slice(-5).reverse().map((entry, idx) => (<div key={idx} style={{ padding: '16px', borderBottom: idx < 4 ? '1px solid #222' : 'none', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}><div style={{ color: '#aaa' }}><strong style={{ color: '#fff' }}>{entry.participantName}</strong> completed <span style={{ color: '#00ffff' }}>{entry.activityName}</span></div><span style={{ padding: '4px 12px', borderRadius: '12px', backgroundColor: 'rgba(0,255,0,0.1)', color: '#00ff00', fontSize: '14px', fontWeight: 'bold', border: '1px solid #00ff00', fontFamily: 'Orbitron, sans-serif' }}>+{entry.points}</span></div>))}</div></div>)}
      </div>);

      const renderActivities = () => (<div>
        <h1 style={{ fontSize: '28px', margin: '0 0 16px 0', color: '#00ffff', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #00ffff' }}>ğŸ¯ SELECT MISSION</h1>
        <input type="text" placeholder="Search missions..." value={searchQuery} onChange={(e) => setSearchQuery(e.target.value)} style={{ width: '100%', padding: '14px 20px', fontSize: '16px', border: '2px solid #00ffff', borderRadius: '12px', marginBottom: '16px', boxSizing: 'border-box', background: 'rgba(0,0,0,0.5)', color: '#fff' }} />
        <div style={{ display: 'flex', gap: '8px', flexWrap: 'wrap', marginBottom: '16px' }}>{['all', 'jump', 'balance', 'strength', 'dance', 'obstacle', 'target', 'yoga', 'game', 'cooldown'].map(cat => (<button key={cat} onClick={() => setActivityFilter(cat)} style={{ padding: '8px 16px', borderRadius: '20px', border: activityFilter === cat ? '2px solid #00ffff' : '1px solid #444', background: activityFilter === cat ? 'rgba(0,255,255,0.1)' : 'transparent', color: activityFilter === cat ? '#00ffff' : '#888', fontWeight: 'bold', fontSize: '13px', cursor: 'pointer', textTransform: 'uppercase', boxShadow: activityFilter === cat ? '0 0 15px rgba(0,255,255,0.3)' : 'none' }}>{cat === 'all' ? 'ğŸŒŸ ALL' : cat}</button>))}</div>
        {getFilteredActivities().map(activity => (<ActivityCard key={activity.id} activity={activity} isFavorite={favorites.includes(activity.id)} onToggleFavorite={toggleFavorite} onComplete={completeActivity} availableEquipment={equipment} participants={participants} activityNotes={activityNotes} onUpdateNote={updateActivityNote} />))}
      </div>);

      const renderFavorites = () => { const favoriteActivities = ACTIVITY_LIBRARY.filter(a => favorites.includes(a.id)); return (<div><h1 style={{ fontSize: '28px', margin: '0 0 24px 0', color: '#00ffff', fontFamily: 'Orbitron, sans-serif', textShadow: '0 0 20px #00ffff' }}>ğŸ’– FAVORITE MISSIONS</h1>{favoriteActivities.length === 0 ? (<div className="neon-card" style={{ textAlign: 'center', padding: '50px', borderRadius: '16px' }}><div style={{ fontSize: '64px', marginBottom: '16px' }}>ğŸ’”</div><h2 style={{ color: '#ff0080', marginBottom: '8px', fontFamily: 'Orbitron, sans-serif' }}>NO FAVORITES YET!</h2><p style={{ color: '#888' }}>Tap the heart on missions to save them here.</p></div>) : favoriteActivities.map(activity => (<ActivityCard key={activity.id} activity={activity} isFavorite={true} onToggleFavorite={toggleFavorite} onComplete={completeActivity} availableEquipment={equipment} participants={participants} activityNotes={activityNotes} onUpdateNote={updateActivityNote} />))}</div>); };

      const renderParticipantDetail = () => {
        if (!selectedParticipant) return null;
        const participant = participants.find(p => p.id === selectedParticipant.id); if (!participant) return null;
        const avatar = AVATARS.find(a => a.id === participant.avatar);
        const color = COLOR_OPTIONS.find(c => c.id === participant.color) || COLOR_OPTIONS[0];
        const currentLevel = LEVELS.filter(l => participant.xp >= l.minXP).pop();
        const nextLevel = LEVELS.find(l => l.minXP > participant.xp);
        const progressToNext = nextLevel ? ((participant.xp - currentLevel.minXP) / (nextLevel.minXP - currentLevel.minXP)) * 100 : 100;
        const stats = getParticipantStats(participant);
        const avatarSpecificBadges = AVATAR_BADGES.filter(b => b.avatarId === participant.avatar);

        return (<div>
          <div style={{ background: 'linear-gradient(135deg, rgba(10,10,30,0.95) 0%, rgba(20,20,50,0.95) 100%)', border: `3px solid ${color.primary}`, borderRadius: '24px', padding: '32px', textAlign: 'center', marginBottom: '24px', boxShadow: `0 0 50px ${color.primary}40` }}>
            <div style={{ width: '110px', height: '110px', borderRadius: '50%', backgroundColor: `${color.primary}20`, border: `3px solid ${color.primary}`, display: 'flex', alignItems: 'center', justifyContent: 'center', fontSize: '60px', margin: '0 auto 16px', boxShadow: `0 0 30px ${color.primary}60`, animation: 'float 3s ease-in-out infinite' }}>{avatar?.emoji}</div>
            <h1 style={{ margin: '0 0 8px 0', fontSize: '32px', fontFamily: 'Orbitron, sans-serif', color: color.primary, textShadow: `0 0 20px ${color.primary}` }}>{participant.name}</h1>
            <div style={{ fontSize: '16px', color: '#888', marginBottom: '20px' }}>Age {participant.age} â€¢ {avatar?.name}</div>
            <div style={{ background: 'rgba(0,0,0,0.3)', borderRadius: '16px', padding: '20px', border: `1px solid ${color.primary}40` }}><div style={{ fontSize: '28px', marginBottom: '12px', fontFamily: 'Orbitron, sans-serif' }}><span style={{ marginRight: '8px' }}>{currentLevel?.emoji}</span><span style={{ color: '#ffff00', textShadow: '0 0 10px #ffff00' }}>{currentLevel?.name}</span></div><div style={{ marginBottom: '8px' }}><div style={{ display: 'flex', justifyContent: 'space-between', fontSize: '12px', marginBottom: '6px', fontFamily: 'Orbitron, sans-serif' }}><span style={{ color: color.primary }}>{participant.xp} XP</span>{nextLevel && <span style={{ color: '#666' }}>{nextLevel.minXP} XP</span>}</div><div style={{ height: '10px', backgroundColor: 'rgba(255,255,255,0.1)', borderRadius: '5px', overflow: 'hidden', border: `1px solid ${color.primary}40` }}><div style={{ height: '100%', width: `${progressToNext}%`, background: color.gradient, borderRadius: '5px', boxShadow: `0 0 15px ${color.primary}` }} /></div></div>{nextLevel && <div style={{ fontSize: '13px', color: '#888' }}>{nextLevel.minXP - participant.xp} XP to {nextLevel.name}</div>}</div>
          </div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(3, 1fr)', gap: '12px', marginBottom: '24px' }}><div className="neon-card" style={{ borderRadius: '12px', padding: '16px', textAlign: 'center', borderColor: '#00ffff' }}><div style={{ fontSize: '32px', marginBottom: '4px' }}>ğŸ†</div><div style={{ fontSize: '24px', fontWeight: 'bold', color: '#00ffff', fontFamily: 'Orbitron, sans-serif' }}>{stats.totalCompleted}</div><div style={{ fontSize: '11px', color: '#888', textTransform: 'uppercase' }}>Completed</div></div><div className="neon-card" style={{ borderRadius: '12px', padding: '16px', textAlign: 'center', borderColor: '#ffff00' }}><div style={{ fontSize: '32px', marginBottom: '4px' }}>â­</div><div style={{ fontSize: '24px', fontWeight: 'bold', color: '#ffff00', fontFamily: 'Orbitron, sans-serif' }}>{participant.xp}</div><div style={{ fontSize: '11px', color: '#888', textTransform: 'uppercase' }}>Total XP</div></div><div className="neon-card" style={{ borderRadius: '12px', padding: '16px', textAlign: 'center', borderColor: '#ff00ff' }}><div style={{ fontSize: '32px', marginBottom: '4px' }}>ğŸ…</div><div style={{ fontSize: '24px', fontWeight: 'bold', color: '#ff00ff', fontFamily: 'Orbitron, sans-serif' }}>{(participant.earnedBadges?.length || 0) + (participant.avatarBadges?.length || 0)}</div><div style={{ fontSize: '11px', color: '#888', textTransform: 'uppercase' }}>Badges</div></div></div>
          <h2 style={{ color: '#ff00ff', marginBottom: '16px', fontFamily: 'Orbitron, sans-serif' }}>ğŸ… BADGES</h2>
          <div style={{ marginBottom: '16px' }}><h3 style={{ color: '#00ffff', marginBottom: '12px', fontFamily: 'Orbitron, sans-serif', fontSize: '14px' }}>{avatar?.emoji} {avatar?.name.toUpperCase()} PROGRESSION</h3><div style={{ display: 'flex', gap: '12px', marginBottom: '16px' }}>{avatarSpecificBadges.map(badge => { const earned = participant.avatarBadges?.includes(badge.id); return (<div key={badge.id} title={`${badge.name}: ${badge.description}`} className="neon-card" style={{ borderRadius: '12px', padding: '12px', textAlign: 'center', flex: '1', opacity: earned ? 1 : 0.3, borderColor: earned ? color.primary : '#333', boxShadow: earned ? `0 0 20px ${color.primary}40` : 'none' }}><div style={{ fontSize: '32px', filter: earned ? `drop-shadow(0 0 10px ${color.primary})` : 'grayscale(100%)' }}>{badge.emoji}</div><div style={{ fontSize: '10px', color: earned ? color.primary : '#666', marginTop: '4px', fontFamily: 'Orbitron, sans-serif' }}>{badge.name}</div><div style={{ fontSize: '9px', color: '#666', marginTop: '2px' }}>({badge.threshold}x)</div></div>); })}</div></div>
          <div style={{ display: 'grid', gridTemplateColumns: 'repeat(auto-fill, minmax(75px, 1fr))', gap: '10px', marginBottom: '24px' }}>{BADGES.map(badge => { const earned = participant.earnedBadges?.includes(badge.id); return (<div key={badge.id} title={`${badge.name}: ${badge.description}`} className="neon-card" style={{ borderRadius: '12px', padding: '10px', textAlign: 'center', opacity: earned ? 1 : 0.25, borderColor: earned ? '#00ffff' : '#333' }}><div style={{ fontSize: '28px', filter: earned ? 'drop-shadow(0 0 8px #00ffff)' : 'grayscale(100%)' }}>{badge.emoji}</div><div style={{ fontSize: '9px', color: earned ? '#00ffff' : '#666', marginTop: '4px' }}>{badge.name}</div></div>); })}</div>
          {participant.completedActivities?.length > 0 && (<><h2 style={{ color: '#00ffff', marginBottom: '16px', fontFamily: 'Orbitron, sans-serif' }}>ğŸ“œ RECENT MISSIONS</h2><div className="neon-card" style={{ borderRadius: '16px', overflow: 'hidden' }}>{participant.completedActivities.slice(-5).reverse().map((completion, idx) => { const activity = ACTIVITY_LIBRARY.find(a => a.id === completion.activityId); return (<div key={idx} style={{ padding: '16px', borderBottom: idx < participant.completedActivities.slice(-5).length - 1 ? '1px solid #222' : 'none', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}><div><div style={{ fontWeight: 'bold', color: '#fff' }}>{activity?.name}</div><div style={{ fontSize: '12px', color: '#666' }}>{new Date(completion.date).toLocaleDateString()}</div></div><span style={{ padding: '4px 12px', borderRadius: '12px', backgroundColor: 'rgba(0,255,0,0.1)', color: '#00ff00', fontSize: '14px', fontWeight: 'bold', border: '1px solid #00ff00', fontFamily: 'Orbitron, sans-serif' }}>+{completion.points}</span></div>); })}</div></>)}
        </div>);
      };

      return (<div style={{ minHeight: '100vh', position: 'relative', zIndex: 2 }}>
        <StarField /><div className="grid-overlay" /><div className="scanlines" />
        <Confetti active={showConfetti} />
        <BadgePopup badge={newBadge} onClose={() => setNewBadge(null)} />
        <LevelUpPopup level={newLevel} onClose={() => setNewLevel(null)} />
        {pointsPopup && <PointsPopup points={pointsPopup.points} participantName={pointsPopup.participantName} onClose={() => setPointsPopup(null)} />}
        {showWheel && <SpinningWheel activities={getEligibleActivities()} onComplete={(activity) => { setShowWheel(false); setSearchQuery(activity.name); setActivityFilter('all'); setView('activities'); }} onClose={() => setShowWheel(false)} />}
        <div style={{ maxWidth: '800px', margin: '0 auto', padding: '20px', position: 'relative', zIndex: 3 }}>
          {view !== 'dashboard' && (<button onClick={() => { setView('dashboard'); setSelectedParticipant(null); setSearchQuery(''); }} style={{ marginBottom: '16px', padding: '10px 20px', borderRadius: '25px', border: '2px solid #00ffff', background: 'transparent', color: '#00ffff', fontWeight: 'bold', cursor: 'pointer', fontFamily: 'Orbitron, sans-serif', boxShadow: '0 0 15px rgba(0,255,255,0.2)' }}>â† BACK</button>)}
          {view === 'dashboard' && renderDashboard()}
          {view === 'activities' && renderActivities()}
          {view === 'favorites' && renderFavorites()}
          {view === 'settings' && <Settings participants={participants} equipment={equipment} activityNotes={activityNotes} onSaveParticipant={saveParticipant} onDeleteParticipant={deleteParticipant} onToggleEquipment={toggleEquipment} />}
          {view === 'participant' && renderParticipantDetail()}
          <div style={{ position: 'fixed', bottom: 0, left: 0, right: 0, background: 'linear-gradient(to top, rgba(10,10,26,0.98) 0%, rgba(10,10,26,0.95) 100%)', borderTop: '2px solid #00ffff', display: 'flex', justifyContent: 'space-around', padding: '12px 0', boxShadow: '0 -5px 30px rgba(0,255,255,0.2)', zIndex: 100 }}>{[{ id: 'dashboard', icon: 'ğŸ ', label: 'HOME' }, { id: 'activities', icon: 'ğŸ¯', label: 'MISSIONS' }, { id: 'favorites', icon: 'ğŸ’–', label: 'FAVS' }, { id: 'settings', icon: 'âš™ï¸', label: 'COMMAND' }].map(nav => (<button key={nav.id} onClick={() => { setView(nav.id); setSelectedParticipant(null); }} style={{ display: 'flex', flexDirection: 'column', alignItems: 'center', gap: '4px', padding: '8px 16px', border: 'none', background: 'none', cursor: 'pointer', color: view === nav.id ? '#00ffff' : '#666' }}><span style={{ fontSize: '24px', filter: view === nav.id ? 'drop-shadow(0 0 10px #00ffff)' : 'none' }}>{nav.icon}</span><span style={{ fontSize: '10px', fontWeight: view === nav.id ? 'bold' : 'normal', fontFamily: 'Orbitron, sans-serif', letterSpacing: '1px' }}>{nav.label}</span></button>))}</div>
          <div style={{ height: '90px' }} />
        </div>
      </div>);
    }

    ReactDOM.render(<App />, document.getElementById('root'));
  </script>
</body>
</html>
